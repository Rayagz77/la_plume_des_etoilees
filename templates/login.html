{% extends 'base.html' %}

{% block title %}Connexion - Ma Librairie{% endblock %}

{% block content %}
<main>
  <div class="auth-container">
    <div class="auth-card">
      <div class="auth-left">
        <div class="auth-header">
          <h1>Content de vous revoir</h1>
          <p class="connect-message">Connectez-vous pour accéder à votre compte</p>
        </div>

        <form method="POST" action="{{ url_for('login_bp.login') }}" class="auth-form">
          <div class="form-group">
            <label for="user_email">Email</label>
            <input type="email" id="user_email" name="user_email" placeholder="votre@email.com" required>
          </div>

          <div class="form-group">
            <label for="user_password">Mot de passe</label>
            <div class="password-input">
              <input type="password" id="user_password" name="user_password" placeholder="••••••••" required>
              <button type="button" class="toggle-password">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <a href="{{ url_for('login_bp.forgot_password') }}" class="forgot-password">
              Mot de passe oublié ?
            </a>
          </div>

          <button type="submit" class="btn btn-primary" id="submitBtn">Se connecter</button>

          <div class="auth-divider">
            <span>ou continuer avec</span>
          </div>

          <div class="social-auth">
            <a href="#" class="social-btn google">
              <i class="fab fa-google"></i> Google
            </a>
            <a href="#" class="social-btn facebook">
              <i class="fab fa-facebook-f"></i> Facebook
            </a>
          </div>
        </form>
      </div>

      <div class="auth-right">
        <div class="welcome-content">
          <h2>Nouveau ici ?</h2>
          <p>Créez un compte pour découvrir notre collection exclusive</p>
          <a href="{{ url_for('register_bp.register') }}" class="btn btn-outline">
            S'inscrire
          </a>
        </div>
      </div>
    </div>
  </div>

  {% if show_forgot_modal %}
  <div class="modal" id="forgotPasswordModal" style="display: block;">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>Mot de passe oublié</h2>
      <form method="POST" action="{{ url_for('login_bp.forgot_password') }}">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" required>
        </div>
        <button type="submit" class="btn btn-primary">Envoyer le lien de réinitialisation</button>
      </form>
    </div>
  </div>
  {% endif %}
</main>

<style>
/* (reprend ton CSS embarqué actuel – inchangé) */
:root {
  --primary: #6c5ce7;
  --primary-dark: #5649c0;
  --text: #2d3748;
  --light: #f8f9fa;
  --gray: #e9ecef;
  --danger: #e53e3e;
  --success: #38a169;
}

.connect-message{
  color:#e53e3e;
  font: 18px;
  margin-top: 7px;
}
.auth-container{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);padding:2rem;}
.auth-card{display:flex;width:100%;max-width:1000px;background:white;border-radius:16px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.1)}
.auth-left{flex:1;padding:3rem}
.auth-right{flex:1;background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;padding:3rem;display:flex;align-items:center}
.auth-header{margin-bottom:2rem}.auth-header h1{font-size:2rem;color:var(--text);margin-bottom:.5rem}.auth-header p{color:#718096}
.auth-form .form-group{margin-bottom:1.5rem}.auth-form label{display:block;margin-bottom:.5rem;font-weight:500;color:var(--text)}
.auth-form input{width:100%;padding:.8rem 1rem;border:1px solid var(--gray);border-radius:8px;font-size:1rem}
.password-input{position:relative}.toggle-password{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:#a0aec0;cursor:pointer}
.forgot-password{display:block;text-align:right;font-size:.8rem;color:var(--primary);margin-top:.5rem;text-decoration:none}
.btn{padding:.8rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;transition:.3s;text-align:center}
.btn-primary{background:var(--primary);color:white;border:none;width:100%}.btn-primary:hover{background:var(--primary-dark)}
.btn-outline{border:2px solid white;background:transparent;color:white;margin-top:15px}
.auth-divider{display:flex;align-items:center;margin:1.5rem 0;color:#718096}
.auth-divider::before,.auth-divider::after{content:'';flex:1;border-bottom:1px solid var(--gray)}.auth-divider::before{margin-right:1rem}.auth-divider::after{margin-left:1rem}
.social-auth{display:flex;gap:1rem}.social-btn{flex:1;padding:.7rem;border-radius:8px;text-align:center;font-weight:500}
.social-btn.google{border:1px solid #DB4437;color:#DB4437}.social-btn.facebook{border:1px solid #4267B2;color:#4267B2}
.welcome-content{text-align:center;width:100%}.welcome-content h2{font-size:1.8rem;margin-bottom:1rem}
.alert{padding:.8rem;border-radius:8px;margin-bottom:1rem}.alert-success{background:rgba(56,161,105,.1);color:var(--success)}.alert-danger{background:rgba(229,62,62,.1);color:var(--danger)}
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5)}
.modal-content{background-color:white;margin:15% auto;padding:2rem;border-radius:8px;width:90%;max-width:500px;position:relative}
.close-modal{position:absolute;right:1rem;top:1rem;font-size:1.5rem;cursor:pointer}
@media (max-width:768px){.auth-card{flex-direction:column}.auth-right{order:-1;padding:2rem}.social-auth{flex-direction:column}}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const toggleBtn = document.querySelector('.toggle-password');
  const pwd = document.getElementById('user_password');
  if (toggleBtn && pwd) {
    toggleBtn.addEventListener('click', function() {
      const type = pwd.getAttribute('type') === 'password' ? 'text' : 'password';
      pwd.setAttribute('type', type);
      this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
    });
  }
  const emailInput = document.getElementById('user_email');
  if (emailInput) emailInput.focus();

  const modal = document.getElementById('forgotPasswordModal');
  if (modal) {
    const closeBtn = document.querySelector('.close-modal');
    closeBtn.addEventListener('click', function(){ modal.style.display='none'; });
    window.addEventListener('click', function(ev){ if (ev.target===modal) modal.style.display='none'; });
  }
});
</script>
{% endblock %}
